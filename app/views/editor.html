<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Editor</title>
  <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css" />
  <script src="jquery-1.7.1.min.js" type="text/javascript"></script>
  <script src="src/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
var editor;
window.onload = function() {
    editor = ace.edit("editor");
	//load default theme and language
    loadTheme("textmate");    
    loadMode("javascript");
    
	//binding the setting panel events
    $("#mode").change(function(e){
    	loadMode(e.target.value);
    })
    $("#theme").change(function(e){
    	loadTheme(e.target.value);
    })
    $("#fontsize").change(function(e){
    	document.getElementById('editor').style.fontSize=e.target.value;
    })
    $("#highlight_active").change(function(e){
    	editor.setHighlightActiveLine(e.target.checked);
    })
	$("#show_hidden").change(function(e){
		editor.setShowInvisibles(e.target.checked);
	})
	$("#soft_wrap").change(function(e){
		var session = editor.getSession();
        var renderer = editor.renderer;
        switch (e.target.value) {
            case "off":
                session.setUseWrapMode(false);
                renderer.setPrintMarginColumn(80);
                break;
            case "40":
                session.setUseWrapMode(true);
                session.setWrapLimitRange(40, 40);
                renderer.setPrintMarginColumn(40);
                break;
            case "80":
                session.setUseWrapMode(true);
                session.setWrapLimitRange(80, 80);
                renderer.setPrintMarginColumn(80);
                break;
            case "free":
                session.setUseWrapMode(true);
                session.setWrapLimitRange(null, null);
                renderer.setPrintMarginColumn(80);
                break;
        }
	})
	$("#show_gutter").change(function(e){
		editor.renderer.setShowGutter(e.target.checked); 
	}) 
	$("#show_print_margin").change(function(e){
		editor.renderer.setShowPrintMargin(e.target.checked); 
	})
	$("#soft_tab").change(function(e){
		editor.getSession().setUseSoftTabs(e.target.checked);  
	})
	$("#highlight_selected_word").change(function(e){
		editor.setHighlightSelectedWord(e.target.checked);
	})
};

var themes = {};
function loadTheme(name) {
	//check if the theme source files have been loaded before
    if(themes[name]){
		editor.setTheme(themes[name]);
		return;
	}

    var fileName = "src/theme-" + name + ".js";
    loadScriptFile(fileName, function(){
		var path = "ace/theme/"+name; 
		themes[name] = path;
    	editor.setTheme(path);
    });
}

var modes = {};
function loadMode(name){
	//check if the language source files have been loaded before         
	if(modes[name]) {
		editor.getSession().setMode(new modes[name]);
		return;
	}
		
	var fileName = "src/mode-" + name + ".js";
	loadScriptFile(fileName, function(){
		var Mode = require("ace/mode/"+name).Mode;
		modes[name] = Mode;
		editor.getSession().setMode(new Mode());
	});
}

//dynamically load javascript source file
function loadScriptFile(path, callback) {
    var head = document.getElementsByTagName('head')[0];
    var s = document.createElement('script');

    s.src = path;
    head.appendChild(s);
    
    s.onload = callback;
}      
</script>     
</head>
<body>        
	<div class="container-fluid">
	<div class="row-fluid">
		<div id="editorSetting" class="span4">
			<table>
				<tr>
					<td >
						<label for="mode">Mode</label>
					</td><td>
						<select id="mode" size="1">
							<option value="javascript" selected>JavaScript</option>
							<option value="xml">XML</option>
							<option value="html">HTML</option>
							<option value="css">CSS</option>
							<option value="scss">SCSS</option>
							<option value="python">Python</option>
							<option value="php">PHP</option>
							<option value="java">Java</option>
							<option value="ruby">Ruby</option>
							<option value="c_cpp">C/C++</option>
							<option value="coffee">CoffeeScript</option>
							<option value="json">JSON</option>
							<option value="perl">Perl</option>
							<option value="clojure">Clojure</option>
							<option value="ocaml">OCaml</option>
							<option value="csharp">C#</option>
							<option value="svg">SVG</option>
							<option value="textile">Textile</option>
							<option value="groovy">Groovy</option>
							<option value="scala">Scala</option>
						</select>
					</td>
				</tr>
				<tr>
					<td >
						<label for="theme">Theme</label>
					</td><td>
						<select id="theme" size="1">
							<option value="clouds">Clouds</option>
							<option value="clouds_midnight">Clouds Midnight</option>
							<option value="cobalt">Cobalt</option>
							<option value="crimson_editor">Crimson Editor</option>
							<option value="dawn">Dawn</option>
							<option value="eclipse">Eclipse</option>
							<option value="idle_fingers">idleFingers</option>
							<option value="kr_theme">krTheme</option>
							<option value="merbivore">Merbivore</option>
							<option value="merbivore_soft">Merbivore Soft</option>
							<option value="mono_industrial">Mono Industrial</option>
							<option value="monokai">Monokai</option>
							<option value="pastel_on_dark">Pastel on dark</option>
							<option value="solarized_dark">Solarized Dark</option>
							<option value="solarized_light">Solarized Light</option>
							<option value="textmate" selected="selected">TextMate</option>
							<option value="twilight">Twilight</option>
							<option value="vibrant_ink">Vibrant Ink</option>
						</select>
					</td>
				</tr>
				<tr>
					<td >
						<label for="fontsize">Font Size</label>
					</td><td>
						<select id="fontsize" size="1">
							<option value="10px">10px</option>
							<option value="11px">11px</option>
							<option value="12px" selected="selected">12px</option>
							<option value="14px">14px</option>
							<option value="16px">16px</option>
							<option value="20px">20px</option>
							<option value="24px">24px</option>
						</select>
					</td>
				</tr>
				<tr>
					<td >
						<label for="highlight_active">Highlight Active Line</label>
					</td><td>
						<input type="checkbox" name="highlight_active" id="highlight_active" checked>
					</td>
				</tr>
				<tr>
					<td >
						<label for="show_hidden">Show Invisibles</label>
					</td><td>
						<input type="checkbox" name="show_hidden" id="show_hidden">
					</td>
				</tr>
				<tr>
					<td >
						<label for="soft_wrap">Soft Wrap</label>
					</td><td>
						<select id="soft_wrap" size="1">
							<option value="off">Off</option>
							<option value="40">40 Chars</option>
							<option value="80">80 Chars</option>
							<option value="free">Free</option>
						</select>
					</td>
				</tr>
				<tr>
					<td >
						<label for="show_gutter">Show Gutter</label>
					</td><td>
						<input type="checkbox" id="show_gutter" checked>
					</td>
				</tr>
				<tr>
					<td >
						<label for="show_print_margin">Show Print Margin</label>
					</td><td>
						<input type="checkbox" id="show_print_margin" checked>
					</td>
				</tr>
				<tr>
					<td >
						<label for="soft_tab">Use Soft Tab</label>
					</td><td>
						<input type="checkbox" id="soft_tab" checked>
					</td>
				</tr>
				<tr>
					<td >
						<label for="highlight_selected_word">Highlight selected word</label>
					</td>
					<td>
						<input type="checkbox" id="highlight_selected_word" checked>
					</td>
				</tr>
			</table>
		</div>

		<div id="editor" class="span8" style="position:relative;height:400px;resize:both;overflow:hidden;">function foo(items) {
		var i;
		for (i = 0; i &lt; items.length; i++) {
			alert("Ace Rocks " + items[i]);
		}
	}
		</div>
		
		
	</div>
    </div>
</body>
</html>
